#
# points(table.mod.optic.dry[,20],height.mod.optic,col="red")
#
#
#
# points(table.caps$ext_mean-table.caps$sca_mean,t.actos$h_mean,col="black")
f.CS <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_CS.txt"
f.HOM <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_HOM.txt"
# t.HOM <- read.table(f.HOM, header=F,sep="\t",stringsAsFactors = F)
# t.CS <- read.table(f.CS, header=F,sep="\t",stringsAsFactors = F)
#
#
#
# plot(t.HOM[,2],t.CS[,2],col="black",pch=19)
#
#
#
# summary(lm(t.CS[,2]~t.HOM[,2]+0))
# summary(lm(t.CS[,3]~t.HOM[,3]+0))
# summary(lm(t.CS[,4]~t.HOM[,4]+0))
# summary(lm(t.CS[,5]~t.HOM[,5]+0))
png("2015-06-28b_HOM_ACTOS_vs_LIDAR.png",width=16*1.5,height=9*1.5,res = 300,units="cm",bg="transparent",family = "serif",pointsize = 12)
par(mfrow=c(1,4),oma=c(5,5,5,1),mar=rep(0.5,4))
plot(rh.new[-length(rh.new)],alt.new[-1],type="n",col="blue",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,95),ylim=c(0,2800))
grid(NULL,NULL,"gray",lty=1)
abline(h=seq(500,2500,500),v=seq(20,80,20),col="gray",lty=1)
lines(rh.new[-length(rh.new)],alt.new[-1],col="blue")
arrows(x0=rh-rh.sd,y0=alt+25,x1=rh+rh.sd,y1=alt+25,col="blue",length=0.04,code=3,angle=90)
axis(1,tck=0.04,cex.axis=1.5)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,expression(paste(italic("rH")," [%]")),line=4,cex=1.5)
par(new=TRUE)
plot(temp.new[-length(temp.new)],alt.new[-1],col="red",type="l",ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,23.75))
axis(3,tck=0.04,cex.axis=1.5)
arrows(x0=temp-temp.sd,y0=alt+20,x1=temp+temp.sd,y1=alt+20,col="red",length=0.04,code=3,angle=90)
mtext(side=3,expression(paste(italic("T")," [°C]")),line=3,cex=1.5)
mtext(side=2,expression(paste(italic("h")," [m]")),line=4,cex=1.5)
plot(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2,type="n",ylim=c(0,2800),xlim=c(0,2.8),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2)
polygon(c(table.lidar[,6]*0.8,rev(table.lidar[,6]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4],table.lidar[,1]*1000,col="green",lwd=2)
polygon(c(table.lidar[,4]*0.8,rev(table.lidar[,4]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2],table.lidar[,1]*1000,col="blue",lwd=2)
polygon(c(table.lidar[,2]*0.8,rev(table.lidar[,2]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,33],height.mod.optic,col="red")
arrows(table.mod.optic[,33]-table.mod.optic.sd[,33],height.mod.optic,table.mod.optic[,33]+table.mod.optic.sd[,33],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,17],height.mod.optic,col="green")
arrows(table.mod.optic[,17]-table.mod.optic.sd[,17],height.mod.optic,table.mod.optic[,17]+table.mod.optic.sd[,17],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,5],height.mod.optic,col="blue")
arrows(table.mod.optic[,5]-table.mod.optic.sd[,5],height.mod.optic,table.mod.optic[,5]+table.mod.optic.sd[,5],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["bsc"]," [Mm"^-1,"sr"^-1,"]")),line=4,cex=1.5)
box()
plot(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2,type="n",xlim=c(0,150),ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2)
lines(table.lidar[,6]*15,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
lines(table.lidar[,6]*45,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
polygon(c(table.lidar[,6]*30*0.8,rev(table.lidar[,6]*30*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4]*55,table.lidar[,1]*1000,col="green",lwd=2)
lines(table.lidar[,4]*70,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
lines(table.lidar[,4]*40,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
polygon(c(table.lidar[,4]*55*0.8,rev(table.lidar[,4]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2]*55,table.lidar[,1]*1000,col="blue",lwd=2)
lines(table.lidar[,2]*70,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
lines(table.lidar[,2]*40,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
polygon(c(table.lidar[,2]*55*0.8,rev(table.lidar[,2]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,30],height.mod.optic,col="red")
arrows(table.mod.optic[,30]-table.mod.optic.sd[,30],height.mod.optic,table.mod.optic[,30]+table.mod.optic.sd[,30],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,14],height.mod.optic,col="green")
arrows(table.mod.optic[,14]-table.mod.optic.sd[,14],height.mod.optic,table.mod.optic[,14]+table.mod.optic.sd[,14],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,2],height.mod.optic,col="blue")
arrows(table.mod.optic[,2]-table.mod.optic.sd[,2],height.mod.optic,table.mod.optic[,2]+table.mod.optic.sd[,2],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
box()
plot(bla[,2],bla[,1]*1000,col="black",lwd=2,ylim=c(0,2800),type="l",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,60))
grid(nx = NULL, ny = NULL, col = "gray", lty = 1,
lwd = par("lwd"), equilogs = TRUE)
lines(bla[,2],bla[,1]*1000,col="black",lwd=2)
polygon(c(bla[,2]*0.8,rev(bla[,2]*1.2)),c(bla[,1]*1000,rev(bla[,1]*1000)),border=rgb(0,0,0,0.3),col=rgb(0,0,0,0.3))
points(table.caps$ext_mean,t.actos$h_mean,col="black",pch=19,)
points(table.mod.optic.dry[,22],height.mod.optic,col="blue",pch=22)
points(wet.ext.caps[,2],t.actos$h_mean,col="red",pch=19)
points(table.mod.optic[,22],height.mod.optic,col="green",pch=22)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
legend("topright",legend=c("lidar 630 nm","CAPS dry","CAPS ambient","Mie ambient","Mie dry"),col=c("black","black","red","green","blue"),merge=T,pch=c(NA,19,19,22,22),lty=c(1,NA,NA,NA,NA),lwd=2,bty="n",cex=1.3)
box()
dev.off()
# plot(table.stap$abs450stp,t.actos$h_mean,type="n",ylim=c(0,3000))
# lines(table.stap$abs450stp,t.actos$h_mean,col="blue")
# lines(table.stap$abs525stp,t.actos$h_mean,col="green")
# lines(table.stap$abs624stp,t.actos$h_mean,col="red")
#
# points(table.mod.optic.dry[,20],height.mod.optic,col="red")
#
#
#
# points(table.caps$ext_mean-table.caps$sca_mean,t.actos$h_mean,col="black")
f.CS <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_CS.txt"
f.HOM <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_HOM.txt"
# t.HOM <- read.table(f.HOM, header=F,sep="\t",stringsAsFactors = F)
# t.CS <- read.table(f.CS, header=F,sep="\t",stringsAsFactors = F)
#
#
#
# plot(t.HOM[,2],t.CS[,2],col="black",pch=19)
#
#
#
# summary(lm(t.CS[,2]~t.HOM[,2]+0))
# summary(lm(t.CS[,3]~t.HOM[,3]+0))
# summary(lm(t.CS[,4]~t.HOM[,4]+0))
# summary(lm(t.CS[,5]~t.HOM[,5]+0))
getwd()
png("2015-06-28b_HOM_ACTOS_vs_LIDAR.png",width=16*1.5,height=9*1.5,res = 300,units="cm",bg="transparent",family = "serif",pointsize = 12)
par(mfrow=c(1,4),oma=c(5,6,5,1),mar=rep(0.5,4))
plot(rh.new[-length(rh.new)],alt.new[-1],type="n",col="blue",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,95),ylim=c(0,2800))
grid(NULL,NULL,"gray",lty=1)
abline(h=seq(500,2500,500),v=seq(20,80,20),col="gray",lty=1)
lines(rh.new[-length(rh.new)],alt.new[-1],col="blue")
arrows(x0=rh-rh.sd,y0=alt+25,x1=rh+rh.sd,y1=alt+25,col="blue",length=0.04,code=3,angle=90)
axis(1,tck=0.04,cex.axis=1.5)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,expression(paste(italic("rH")," [%]")),line=4,cex=1.5)
par(new=TRUE)
plot(temp.new[-length(temp.new)],alt.new[-1],col="red",type="l",ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,23.75))
axis(3,tck=0.04,cex.axis=1.5)
arrows(x0=temp-temp.sd,y0=alt+20,x1=temp+temp.sd,y1=alt+20,col="red",length=0.04,code=3,angle=90)
mtext(side=3,expression(paste(italic("T")," [°C]")),line=3,cex=1.5)
mtext(side=2,expression(paste(italic("h")," [m]")),line=4,cex=1.5)
plot(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2,type="n",ylim=c(0,2800),xlim=c(0,2.8),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2)
polygon(c(table.lidar[,6]*0.8,rev(table.lidar[,6]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4],table.lidar[,1]*1000,col="green",lwd=2)
polygon(c(table.lidar[,4]*0.8,rev(table.lidar[,4]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2],table.lidar[,1]*1000,col="blue",lwd=2)
polygon(c(table.lidar[,2]*0.8,rev(table.lidar[,2]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,33],height.mod.optic,col="red")
arrows(table.mod.optic[,33]-table.mod.optic.sd[,33],height.mod.optic,table.mod.optic[,33]+table.mod.optic.sd[,33],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,17],height.mod.optic,col="green")
arrows(table.mod.optic[,17]-table.mod.optic.sd[,17],height.mod.optic,table.mod.optic[,17]+table.mod.optic.sd[,17],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,5],height.mod.optic,col="blue")
arrows(table.mod.optic[,5]-table.mod.optic.sd[,5],height.mod.optic,table.mod.optic[,5]+table.mod.optic.sd[,5],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["bsc"]," [Mm"^-1,"sr"^-1,"]")),line=4,cex=1.5)
box()
plot(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2,type="n",xlim=c(0,150),ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2)
lines(table.lidar[,6]*15,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
lines(table.lidar[,6]*45,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
polygon(c(table.lidar[,6]*30*0.8,rev(table.lidar[,6]*30*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4]*55,table.lidar[,1]*1000,col="green",lwd=2)
lines(table.lidar[,4]*70,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
lines(table.lidar[,4]*40,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
polygon(c(table.lidar[,4]*55*0.8,rev(table.lidar[,4]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2]*55,table.lidar[,1]*1000,col="blue",lwd=2)
lines(table.lidar[,2]*70,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
lines(table.lidar[,2]*40,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
polygon(c(table.lidar[,2]*55*0.8,rev(table.lidar[,2]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,30],height.mod.optic,col="red")
arrows(table.mod.optic[,30]-table.mod.optic.sd[,30],height.mod.optic,table.mod.optic[,30]+table.mod.optic.sd[,30],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,14],height.mod.optic,col="green")
arrows(table.mod.optic[,14]-table.mod.optic.sd[,14],height.mod.optic,table.mod.optic[,14]+table.mod.optic.sd[,14],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,2],height.mod.optic,col="blue")
arrows(table.mod.optic[,2]-table.mod.optic.sd[,2],height.mod.optic,table.mod.optic[,2]+table.mod.optic.sd[,2],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
box()
plot(bla[,2],bla[,1]*1000,col="black",lwd=2,ylim=c(0,2800),type="l",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,60))
grid(nx = NULL, ny = NULL, col = "gray", lty = 1,
lwd = par("lwd"), equilogs = TRUE)
lines(bla[,2],bla[,1]*1000,col="black",lwd=2)
polygon(c(bla[,2]*0.8,rev(bla[,2]*1.2)),c(bla[,1]*1000,rev(bla[,1]*1000)),border=rgb(0,0,0,0.3),col=rgb(0,0,0,0.3))
points(table.caps$ext_mean,t.actos$h_mean,col="black",pch=19,)
points(table.mod.optic.dry[,22],height.mod.optic,col="blue",pch=22)
points(wet.ext.caps[,2],t.actos$h_mean,col="red",pch=19)
points(table.mod.optic[,22],height.mod.optic,col="green",pch=22)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
legend("topright",legend=c("lidar 630 nm","CAPS dry","CAPS ambient","Mie ambient","Mie dry"),col=c("black","black","red","green","blue"),merge=T,pch=c(NA,19,19,22,22),lty=c(1,NA,NA,NA,NA),lwd=2,bty="n",cex=1.3)
box()
dev.off()
# plot(table.stap$abs450stp,t.actos$h_mean,type="n",ylim=c(0,3000))
# lines(table.stap$abs450stp,t.actos$h_mean,col="blue")
# lines(table.stap$abs525stp,t.actos$h_mean,col="green")
# lines(table.stap$abs624stp,t.actos$h_mean,col="red")
#
# points(table.mod.optic.dry[,20],height.mod.optic,col="red")
#
#
#
# points(table.caps$ext_mean-table.caps$sca_mean,t.actos$h_mean,col="black")
f.CS <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_CS.txt"
f.HOM <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_HOM.txt"
# t.HOM <- read.table(f.HOM, header=F,sep="\t",stringsAsFactors = F)
# t.CS <- read.table(f.CS, header=F,sep="\t",stringsAsFactors = F)
#
#
#
# plot(t.HOM[,2],t.CS[,2],col="black",pch=19)
#
#
#
# summary(lm(t.CS[,2]~t.HOM[,2]+0))
# summary(lm(t.CS[,3]~t.HOM[,3]+0))
# summary(lm(t.CS[,4]~t.HOM[,4]+0))
# summary(lm(t.CS[,5]~t.HOM[,5]+0))
table.mod.optic <- read.table(choose.files("Optik-File"),sep="\t")
table.mod.optic.sd <- read.table(choose.files("Optik-File"),sep="\t")
table.mod.optic.dry <- read.table("file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150628b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_dry_CS.txt",sep="\t",header=F)
names(table.mod.optic) <- c("time",as.character(sort(rep(c(355,450,525,532,624,630,880,1064),4))))
names(table.mod.optic.sd) <- c("time",as.character(sort(rep(c(355,450,525,532,624,630,880,1064),4))))
time.mod.optic<-table.mod.optic[,1]
height.mod.optic<-vector(mode = "numeric",length = nrow(table.mod.optic))
for (i in 1:nrow(table.mod.optic)){
height.mod.optic[i]<-mean(table.actos[which((table.actos[,2]<=(time.mod.optic[i]+121))&(table.actos[,2]>=time.mod.optic[i])),6])
}
table.lidar<-read.table("file:///X:/p3_working/SDuesing-home/Data/MelCol/LIDAR/analyzed/20150628-1307-1312_melpitz/20150628-1307-1312-Klett-heightdependent-smoothing-Vaisala.txt",sep="\t",skip=1)
bla<-matrix(ncol = 2,nrow=nrow(table.lidar))
for (k in 1:nrow(table.lidar)){
#bla[k]<-angst.ext(lambda1lidar = 355,lambda2lidar = 532,ext.lambda1lidar = table.lidar[k,2]*55,ext.lambda2lidar = table.lidar[k,4]*55,new.wavelength = 630)[2]
bla[k,2]<-angst.ext(lambda1lidar = 355,lambda2lidar = 532,ext.lambda1lidar = table.lidar[k,2]*55,ext.lambda2lidar = table.lidar[k,4]*55,new.wavelength = 630)[2]
bla[k,1] <-  table.lidar[k,1]
}
bla[which(table.lidar[,1]*1000<400)]<-NA
bla[which(table.lidar[,1]*1000>=2800)]<-NA
table.lidar[which(table.lidar[,1]*1000<400),]<-NA
table.lidar[which(table.lidar[,1]*1000>=2800),]<-NA
table.lidar <- table.lidar[complete.cases(table.lidar),]
bla <- bla[complete.cases(bla),]
png("2015-06-28b_CS_ACTOS_vs_LIDAR.png",width=16*1.5,height=9*1.5,res = 300,units="cm",bg="transparent",family = "serif",pointsize = 12)
par(mfrow=c(1,4),oma=c(5,6,5,1),mar=rep(0.5,4))
plot(rh.new[-length(rh.new)],alt.new[-1],type="n",col="blue",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,95),ylim=c(0,2800))
grid(NULL,NULL,"gray",lty=1)
abline(h=seq(500,2500,500),v=seq(20,80,20),col="gray",lty=1)
lines(rh.new[-length(rh.new)],alt.new[-1],col="blue")
arrows(x0=rh-rh.sd,y0=alt+25,x1=rh+rh.sd,y1=alt+25,col="blue",length=0.04,code=3,angle=90)
axis(1,tck=0.04,cex.axis=1.5)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,expression(paste(italic("rH")," [%]")),line=4,cex=1.5)
par(new=TRUE)
plot(temp.new[-length(temp.new)],alt.new[-1],col="red",type="l",ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,23.75))
axis(3,tck=0.04,cex.axis=1.5)
arrows(x0=temp-temp.sd,y0=alt+20,x1=temp+temp.sd,y1=alt+20,col="red",length=0.04,code=3,angle=90)
mtext(side=3,expression(paste(italic("T")," [°C]")),line=3,cex=1.5)
mtext(side=2,expression(paste(italic("h")," [m]")),line=4,cex=1.5)
plot(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2,type="n",ylim=c(0,2800),xlim=c(0,2.8),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2)
polygon(c(table.lidar[,6]*0.8,rev(table.lidar[,6]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4],table.lidar[,1]*1000,col="green",lwd=2)
polygon(c(table.lidar[,4]*0.8,rev(table.lidar[,4]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2],table.lidar[,1]*1000,col="blue",lwd=2)
polygon(c(table.lidar[,2]*0.8,rev(table.lidar[,2]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,33],height.mod.optic,col="red")
arrows(table.mod.optic[,33]-table.mod.optic.sd[,33],height.mod.optic,table.mod.optic[,33]+table.mod.optic.sd[,33],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,17],height.mod.optic,col="green")
arrows(table.mod.optic[,17]-table.mod.optic.sd[,17],height.mod.optic,table.mod.optic[,17]+table.mod.optic.sd[,17],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,5],height.mod.optic,col="blue")
arrows(table.mod.optic[,5]-table.mod.optic.sd[,5],height.mod.optic,table.mod.optic[,5]+table.mod.optic.sd[,5],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["bsc"]," [Mm"^-1,"sr"^-1,"]")),line=4,cex=1.5)
box()
plot(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2,type="n",xlim=c(0,150),ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2)
lines(table.lidar[,6]*15,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
lines(table.lidar[,6]*45,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
polygon(c(table.lidar[,6]*30*0.8,rev(table.lidar[,6]*30*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4]*55,table.lidar[,1]*1000,col="green",lwd=2)
lines(table.lidar[,4]*70,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
lines(table.lidar[,4]*40,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
polygon(c(table.lidar[,4]*55*0.8,rev(table.lidar[,4]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2]*55,table.lidar[,1]*1000,col="blue",lwd=2)
lines(table.lidar[,2]*70,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
lines(table.lidar[,2]*40,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
polygon(c(table.lidar[,2]*55*0.8,rev(table.lidar[,2]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,30],height.mod.optic,col="red")
arrows(table.mod.optic[,30]-table.mod.optic.sd[,30],height.mod.optic,table.mod.optic[,30]+table.mod.optic.sd[,30],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,14],height.mod.optic,col="green")
arrows(table.mod.optic[,14]-table.mod.optic.sd[,14],height.mod.optic,table.mod.optic[,14]+table.mod.optic.sd[,14],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,2],height.mod.optic,col="blue")
arrows(table.mod.optic[,2]-table.mod.optic.sd[,2],height.mod.optic,table.mod.optic[,2]+table.mod.optic.sd[,2],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
box()
plot(bla[,2],bla[,1]*1000,col="black",lwd=2,ylim=c(0,2800),type="l",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,60))
grid(nx = NULL, ny = NULL, col = "gray", lty = 1,
lwd = par("lwd"), equilogs = TRUE)
lines(bla[,2],bla[,1]*1000,col="black",lwd=2)
polygon(c(bla[,2]*0.8,rev(bla[,2]*1.2)),c(bla[,1]*1000,rev(bla[,1]*1000)),border=rgb(0,0,0,0.3),col=rgb(0,0,0,0.3))
points(table.caps$ext_mean,t.actos$h_mean,col="black",pch=19,)
points(table.mod.optic.dry[,22],height.mod.optic,col="blue",pch=22)
points(wet.ext.caps[,2],t.actos$h_mean,col="red",pch=19)
points(table.mod.optic[,22],height.mod.optic,col="green",pch=22)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
legend("topright",legend=c("lidar 630 nm","CAPS dry","CAPS ambient","Mie ambient","Mie dry"),col=c("black","black","red","green","blue"),merge=T,pch=c(NA,19,19,22,22),lty=c(1,NA,NA,NA,NA),lwd=2,bty="n",cex=1.3)
box()
dev.off()
# plot(table.stap$abs450stp,t.actos$h_mean,type="n",ylim=c(0,3000))
# lines(table.stap$abs450stp,t.actos$h_mean,col="blue")
# lines(table.stap$abs525stp,t.actos$h_mean,col="green")
# lines(table.stap$abs624stp,t.actos$h_mean,col="red")
#
# points(table.mod.optic.dry[,20],height.mod.optic,col="red")
#
#
#
# points(table.caps$ext_mean-table.caps$sca_mean,t.actos$h_mean,col="black")
f.CS <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_CS.txt"
f.HOM <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_HOM.txt"
# t.HOM <- read.table(f.HOM, header=F,sep="\t",stringsAsFactors = F)
# t.CS <- read.table(f.CS, header=F,sep="\t",stringsAsFactors = F)
#
#
#
# plot(t.HOM[,2],t.CS[,2],col="black",pch=19)
#
#
#
# summary(lm(t.CS[,2]~t.HOM[,2]+0))
# summary(lm(t.CS[,3]~t.HOM[,3]+0))
# summary(lm(t.CS[,4]~t.HOM[,4]+0))
# summary(lm(t.CS[,5]~t.HOM[,5]+0))
table.mod.optic <- read.table("file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150628b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_ground_50_wet_HOM.txt",sep="\t")
table.mod.optic.sd <- read.table("file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150628b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_ground_50_wet_HOM_SD".txt,sep="\t")
table.mod.optic.dry <- read.table("file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150628b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_dry_CS.txt",sep="\t",header=F)
names(table.mod.optic) <- c("time",as.character(sort(rep(c(355,450,525,532,624,630,880,1064),4))))
names(table.mod.optic.sd) <- c("time",as.character(sort(rep(c(355,450,525,532,624,630,880,1064),4))))
time.mod.optic<-table.mod.optic[,1]
height.mod.optic<-vector(mode = "numeric",length = nrow(table.mod.optic))
for (i in 1:nrow(table.mod.optic)){
height.mod.optic[i]<-mean(table.actos[which((table.actos[,2]<=(time.mod.optic[i]+121))&(table.actos[,2]>=time.mod.optic[i])),6])
}
table.lidar<-read.table("file:///X:/p3_working/SDuesing-home/Data/MelCol/LIDAR/analyzed/20150628-1307-1312_melpitz/20150628-1307-1312-Klett-heightdependent-smoothing-Vaisala.txt",sep="\t",skip=1)
bla<-matrix(ncol = 2,nrow=nrow(table.lidar))
for (k in 1:nrow(table.lidar)){
#bla[k]<-angst.ext(lambda1lidar = 355,lambda2lidar = 532,ext.lambda1lidar = table.lidar[k,2]*55,ext.lambda2lidar = table.lidar[k,4]*55,new.wavelength = 630)[2]
bla[k,2]<-angst.ext(lambda1lidar = 355,lambda2lidar = 532,ext.lambda1lidar = table.lidar[k,2]*55,ext.lambda2lidar = table.lidar[k,4]*55,new.wavelength = 630)[2]
bla[k,1] <-  table.lidar[k,1]
}
bla[which(table.lidar[,1]*1000<400)]<-NA
bla[which(table.lidar[,1]*1000>=2800)]<-NA
table.lidar[which(table.lidar[,1]*1000<400),]<-NA
table.lidar[which(table.lidar[,1]*1000>=2800),]<-NA
table.lidar <- table.lidar[complete.cases(table.lidar),]
bla <- bla[complete.cases(bla),]
png("2015-06-28b_HOM_Ground_vs_LIDAR.png",width=16*1.5,height=9*1.5,res = 300,units="cm",bg="transparent",family = "serif",pointsize = 12)
par(mfrow=c(1,4),oma=c(5,6,5,1),mar=rep(0.5,4))
plot(rh.new[-length(rh.new)],alt.new[-1],type="n",col="blue",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,95),ylim=c(0,2800))
grid(NULL,NULL,"gray",lty=1)
abline(h=seq(500,2500,500),v=seq(20,80,20),col="gray",lty=1)
lines(rh.new[-length(rh.new)],alt.new[-1],col="blue")
arrows(x0=rh-rh.sd,y0=alt+25,x1=rh+rh.sd,y1=alt+25,col="blue",length=0.04,code=3,angle=90)
axis(1,tck=0.04,cex.axis=1.5)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,expression(paste(italic("rH")," [%]")),line=4,cex=1.5)
par(new=TRUE)
plot(temp.new[-length(temp.new)],alt.new[-1],col="red",type="l",ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,23.75))
axis(3,tck=0.04,cex.axis=1.5)
arrows(x0=temp-temp.sd,y0=alt+20,x1=temp+temp.sd,y1=alt+20,col="red",length=0.04,code=3,angle=90)
mtext(side=3,expression(paste(italic("T")," [°C]")),line=3,cex=1.5)
mtext(side=2,expression(paste(italic("h")," [m]")),line=4,cex=1.5)
plot(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2,type="n",ylim=c(0,2800),xlim=c(0,2.8),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6],table.lidar[,1]*1000,col="red",lwd=2)
polygon(c(table.lidar[,6]*0.8,rev(table.lidar[,6]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4],table.lidar[,1]*1000,col="green",lwd=2)
polygon(c(table.lidar[,4]*0.8,rev(table.lidar[,4]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2],table.lidar[,1]*1000,col="blue",lwd=2)
polygon(c(table.lidar[,2]*0.8,rev(table.lidar[,2]*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,33],height.mod.optic,col="red")
arrows(table.mod.optic[,33]-table.mod.optic.sd[,33],height.mod.optic,table.mod.optic[,33]+table.mod.optic.sd[,33],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,17],height.mod.optic,col="green")
arrows(table.mod.optic[,17]-table.mod.optic.sd[,17],height.mod.optic,table.mod.optic[,17]+table.mod.optic.sd[,17],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,5],height.mod.optic,col="blue")
arrows(table.mod.optic[,5]-table.mod.optic.sd[,5],height.mod.optic,table.mod.optic[,5]+table.mod.optic.sd[,5],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["bsc"]," [Mm"^-1,"sr"^-1,"]")),line=4,cex=1.5)
box()
plot(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2,type="n",xlim=c(0,150),ylim=c(0,2800),xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,)
grid(NULL,NULL,"gray",lty=1)
lines(table.lidar[,6]*30,table.lidar[,1]*1000,col="red",lwd=2)
lines(table.lidar[,6]*15,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
lines(table.lidar[,6]*45,table.lidar[,1]*1000,col="red",lwd=2,lty=2)
polygon(c(table.lidar[,6]*30*0.8,rev(table.lidar[,6]*30*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(1,0,0,0.3),col=rgb(1,0,0,0.3))
lines(table.lidar[,4]*55,table.lidar[,1]*1000,col="green",lwd=2)
lines(table.lidar[,4]*70,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
lines(table.lidar[,4]*40,table.lidar[,1]*1000,col="green",lwd=2,lty=2)
polygon(c(table.lidar[,4]*55*0.8,rev(table.lidar[,4]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,1,0,0.3),col=rgb(0,1,0,0.3))
lines(table.lidar[,2]*55,table.lidar[,1]*1000,col="blue",lwd=2)
lines(table.lidar[,2]*70,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
lines(table.lidar[,2]*40,table.lidar[,1]*1000,col="blue",lwd=2,lty=2)
polygon(c(table.lidar[,2]*55*0.8,rev(table.lidar[,2]*55*1.2)),c(table.lidar[,1]*1000,rev(table.lidar[,1]*1000)),border=rgb(0,0,1,0.3),col=rgb(0,0,1,0.3))
points(table.mod.optic[,30],height.mod.optic,col="red")
arrows(table.mod.optic[,30]-table.mod.optic.sd[,30],height.mod.optic,table.mod.optic[,30]+table.mod.optic.sd[,30],height.mod.optic,col="red",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,14],height.mod.optic,col="green")
arrows(table.mod.optic[,14]-table.mod.optic.sd[,14],height.mod.optic,table.mod.optic[,14]+table.mod.optic.sd[,14],height.mod.optic,col="green",length = 0.04,angle=90,lwd=2,code = 3)
points(table.mod.optic[,2],height.mod.optic,col="blue")
arrows(table.mod.optic[,2]-table.mod.optic.sd[,2],height.mod.optic,table.mod.optic[,2]+table.mod.optic.sd[,2],height.mod.optic,col="blue",length = 0.04,angle=90,lwd=2,code = 3)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
box()
plot(bla[,2],bla[,1]*1000,col="black",lwd=2,ylim=c(0,2800),type="l",xaxt="n",yaxt="n",xaxs="i",yaxs="i",xlab=NA,ylab=NA,xlim=c(0,60))
grid(nx = NULL, ny = NULL, col = "gray", lty = 1,
lwd = par("lwd"), equilogs = TRUE)
lines(bla[,2],bla[,1]*1000,col="black",lwd=2)
polygon(c(bla[,2]*0.8,rev(bla[,2]*1.2)),c(bla[,1]*1000,rev(bla[,1]*1000)),border=rgb(0,0,0,0.3),col=rgb(0,0,0,0.3))
points(table.caps$ext_mean,t.actos$h_mean,col="black",pch=19,)
points(table.mod.optic.dry[,22],height.mod.optic,col="blue",pch=22)
points(wet.ext.caps[,2],t.actos$h_mean,col="red",pch=19)
points(table.mod.optic[,22],height.mod.optic,col="green",pch=22)
axis(1,tck=0.04,cex.axis=1.5)
mtext(side=1,expression(paste(italic(sigma)["ext"]," [Mm"^-1,"]")),line=4,cex=1.5)
legend("topright",legend=c("lidar 630 nm","CAPS dry","CAPS ambient","Mie ambient","Mie dry"),col=c("black","black","red","green","blue"),merge=T,pch=c(NA,19,19,22,22),lty=c(1,NA,NA,NA,NA),lwd=2,bty="n",cex=1.3)
box()
dev.off()
# plot(table.stap$abs450stp,t.actos$h_mean,type="n",ylim=c(0,3000))
# lines(table.stap$abs450stp,t.actos$h_mean,col="blue")
# lines(table.stap$abs525stp,t.actos$h_mean,col="green")
# lines(table.stap$abs624stp,t.actos$h_mean,col="red")
#
# points(table.mod.optic.dry[,20],height.mod.optic,col="red")
#
#
#
# points(table.caps$ext_mean-table.caps$sca_mean,t.actos$h_mean,col="black")
f.CS <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_CS.txt"
f.HOM <- "file:///C:/Users/duesing/PycharmProjects/MieCalculations/20150626a_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_50_wet_HOM.txt"
# t.HOM <- read.table(f.HOM, header=F,sep="\t",stringsAsFactors = F)
# t.CS <- read.table(f.CS, header=F,sep="\t",stringsAsFactors = F)
#
#
#
# plot(t.HOM[,2],t.CS[,2],col="black",pch=19)
#
#
#
# summary(lm(t.CS[,2]~t.HOM[,2]+0))
# summary(lm(t.CS[,3]~t.HOM[,3]+0))
# summary(lm(t.CS[,4]~t.HOM[,4]+0))
# summary(lm(t.CS[,5]~t.HOM[,5]+0))
png(paste("20150617b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_",minheight,"bis",maxheight,".png",sep=""),width = 16*1.5,height=9*1.5,units = "cm",res=300,family = "serif",pointsize = 1,bg = "transparent")
par(oma=c(5,6.5,1,2),mar=rep(0.2,4))
plot(t(diameter.ground),t(concGround),type="n",log="x",xlim=c(5,10000),xaxs="i",yaxs="i",ylim=c(0,1e4),xaxt="n",yaxt="n",xlab=NA,ylab=NA)
abline(h=seq(0,30000,5000),v=c(1:9 %o% 10^(0:4)),lty=1,col="gray")
lines(t(diameter.ground),t(concGround),col="black",lwd=2)
arrows(t(diameter.ground),t(concGround)*0.9,t(diameter.ground),t(concGround)*1.1,code=3,length = 0.04,angle=90,lwd=2)
lines(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc),col="red",lwd=2)
arrows(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)-lowerleverconcSD,t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)+lowerleverconcSD,col="red",code=3,length=0.04,angle = 90,lwd=2)
axis(1,tck=0.04,cex.axis=1.5)
axis(1,at=c(1:9 %o% 10^(0:4)),labels=F,tck=0.02)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,line=3,expression(paste(italic("D")["p"]," [nm]")),cex=1.5)
mtext(side=2,line=4.5,expression(paste(italic("dN/dlogD")["p"]," [cm"^-3,"]")),cex=1.5)
legend("topright",legend=c("ground",paste("ACTOS ",minheight," bis" ,maxheight," m",sep="")),col=c("black","red"),lty=1,lwd=2,cex=1.5,bty="n")
box()
dev.off()
png(paste("20150617b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_",minheight,"bis",maxheight,"loglog.png",sep=""),width = 16*1.5,height=9*1.5,units = "cm",res=300,family = "serif",pointsize = 12,bg = "transparent")
par(oma=c(5,6.5,1,2),mar=rep(0.2,4))
plot(t(diameter.ground),t(concGround),type="n",log="xy",xlim=c(5,10000),xaxs="i",yaxs="i",ylim=c(1e-4,1e4),xaxt="n",yaxt="n",xlab=NA,ylab=NA)
abline(h=c(1:9 %o% 10^(-4:4)),v=c(1:9 %o% 10^(0:4)),lty=1,col="gray")
lines(t(diameter.ground),t(concGround),col="black",lwd=2)
arrows(t(diameter.ground),t(concGround)*0.9,t(diameter.ground),t(concGround)*1.1,code=3,length = 0.04,angle=90,lwd=2)
lines(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc),col="red",lwd=2)
arrows(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)-lowerleverconcSD,t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)+lowerleverconcSD,col="red",code=3,length=0.04,angle = 90,lwd=2)
axis(1,tck=0.04,cex.axis=1.5)
axis(1,at=c(1:9 %o% 10^(0:4)),labels=F,tck=0.02)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,line=3,expression(paste(italic("D")["p"]," [nm]")),cex=1.5)
mtext(side=2,line=4.5,expression(paste(italic("dN/dlogD")["p"]," [cm"^-3,"]")),cex=1.5)
legend("topright",legend=c("ground",paste("ACTOS ",minheight," bis" ,maxheight," m",sep="")),col=c("black","red"),lty=1,lwd=2,cex=1.5,bty="n")
box()
dev.off()
png(paste("20150617b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_",minheight,"bis",maxheight,".png",sep=""),width = 16*1.5,height=9*1.5,units = "cm",res=300,family = "serif",pointsize = 12,bg = "transparent")
par(oma=c(5,6.5,1,2),mar=rep(0.2,4))
plot(t(diameter.ground),t(concGround),type="n",log="x",xlim=c(5,10000),xaxs="i",yaxs="i",ylim=c(0,1e4),xaxt="n",yaxt="n",xlab=NA,ylab=NA)
abline(h=seq(0,30000,5000),v=c(1:9 %o% 10^(0:4)),lty=1,col="gray")
lines(t(diameter.ground),t(concGround),col="black",lwd=2)
arrows(t(diameter.ground),t(concGround)*0.9,t(diameter.ground),t(concGround)*1.1,code=3,length = 0.04,angle=90,lwd=2)
lines(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc),col="red",lwd=2)
arrows(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)-lowerleverconcSD,t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)+lowerleverconcSD,col="red",code=3,length=0.04,angle = 90,lwd=2)
axis(1,tck=0.04,cex.axis=1.5)
axis(1,at=c(1:9 %o% 10^(0:4)),labels=F,tck=0.02)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,line=3,expression(paste(italic("D")["p"]," [nm]")),cex=1.5)
mtext(side=2,line=4.5,expression(paste(italic("dN/dlogD")["p"]," [cm"^-3,"]")),cex=1.5)
legend("topright",legend=c("ground",paste("ACTOS ",minheight," bis" ,maxheight," m",sep="")),col=c("black","red"),lty=1,lwd=2,cex=1.5,bty="n")
box()
dev.off()
png(paste("20150617b_lastcorr_smoothed_g0_diffkorr_ab8nm_totKorr_cpceff_inletcorr_final_",minheight,"bis",maxheight,"loglog.png",sep=""),width = 16*1.5,height=9*1.5,units = "cm",res=300,family = "serif",pointsize = 12,bg = "transparent")
par(oma=c(5,6.5,1,2),mar=rep(0.2,4))
plot(t(diameter.ground),t(concGround),type="n",log="xy",xlim=c(5,10000),xaxs="i",yaxs="i",ylim=c(1e-4,1e4),xaxt="n",yaxt="n",xlab=NA,ylab=NA)
abline(h=c(1:9 %o% 10^(-4:4)),v=c(1:9 %o% 10^(0:4)),lty=1,col="gray")
lines(t(diameter.ground),t(concGround),col="black",lwd=2)
arrows(t(diameter.ground),t(concGround)*0.9,t(diameter.ground),t(concGround)*1.1,code=3,length = 0.04,angle=90,lwd=2)
lines(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc),col="red",lwd=2)
arrows(t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)-lowerleverconcSD,t(table.pnsd[1,5:ncol(table.pnsd)]),t(lowerleverconc)+lowerleverconcSD,col="red",code=3,length=0.04,angle = 90,lwd=2)
axis(1,tck=0.04,cex.axis=1.5)
axis(1,at=c(1:9 %o% 10^(0:4)),labels=F,tck=0.02)
axis(2,tck=0.04,cex.axis=1.5,las=1)
mtext(side=1,line=3,expression(paste(italic("D")["p"]," [nm]")),cex=1.5)
mtext(side=2,line=4.5,expression(paste(italic("dN/dlogD")["p"]," [cm"^-3,"]")),cex=1.5)
legend("topright",legend=c("ground",paste("ACTOS ",minheight," bis" ,maxheight," m",sep="")),col=c("black","red"),lty=1,lwd=2,cex=1.5,bty="n")
box()
dev.off()
